<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:p="http://primefaces.org/ui" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" template="/templates/modelo.xhtml">


   <p:growl id="mensagem" />

   <ui:define name="conteudo">
      <!-- Tela de listagem -->
      <h:form id="frmListagem">
         <p:panel header="Listagem de Empresas">
            <p:dataTable id="tabela" emptyMessage="Nenhum registro encontrado" paginator="true" value="#{empresaControle.empresas}" paginatorPosition="top" var="empresa" rows="5">
               <f:facet name="footer">
                  <p:commandButton value="Novo" icon="ui-icon-plus" oncomplete="PF('dialogo').show();" actionListener="#{empresaControle.novo}" update=":frmCadastro">
                     <f:actionListener type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
                  </p:commandButton>
               </f:facet>
               <p:column headerText="Razão Social" style="width:30%">
                  <h:outputText value="#{empresa.razaoSocial}" />
               </p:column>

               <p:column headerText="Fantasia" style="width:15%">
                  <h:outputText value="#{empresa.fantasia}" />
               </p:column>

               <p:column headerText="E-mail" style="width:15%">
                  <h:outputText value="#{empresa.email}" />
               </p:column>

               <p:column headerText="CNPJ" style="width:7%">
                  <h:outputText value="#{empresa.cnpj}" />
               </p:column>


               <p:column headerText="Opções" style="width:7%">
                  <p:commandButton icon="ui-icon-trash" actionListener="#{cadastroControle.excluir}" update=":mensagem :frmListagem:tabela">
                     <p:confirm header="Confirmação" message="Deseja excluir o registro?" icon="ui-icon-alert" />
                     <f:attribute name="registroSelecionado" value="#{empresa}" />
                  </p:commandButton>
                  <p:commandButton icon="ui-icon-pencil" actionListener="#{empresaControle.editar}" update=":frmCadastro" oncomplete="PF('dialogo').show();">
                     <!--  -->

                     <f:attribute name="registroSelecionado" value="#{empresa}" />
                     <f:actionListener type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
                  </p:commandButton>
               </p:column>

            </p:dataTable>
            <!-- Botão de opções -->
            <p:confirmDialog global="true">
               <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
               <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
            </p:confirmDialog>

         </p:panel>

      </h:form>

      <!-- Tela de cadastros -->
      <p:dialog header="Cadastro de empresa" widgetVar="dialogo" draggable="true" resizable="false" modal="true">
         <h:form id="frmCadastro">


            <h:panelGrid id="painel2" columns="6">
               <p:outputLabel for="cnpj" value="CNPJ:" />
               <p:inputMask mask="99.999.999/9999-99" id="cnpj" size="18" maxlength="18" value="#{empresaControle.empresa.cnpj}" />

               <p:outputLabel for="ie" value="Inscrição Estadual:" />
               <p:inputText id="ie" size="30" maxlength="30" value="#{empresaControle.empresa.inscEstadual}" />

               <h:outputText for="ativo" value="Ativo: " />
               <p:selectBooleanCheckbox value="#{empresaControle.empresa.ativo}" />

            </h:panelGrid>

            <h:panelGrid id="painel4" columns="2">
               <p:outputLabel for="razao" value="Razão Social:" />
               <p:inputText id="razao" value="#{empresaControle.empresa.razaoSocial}" size="100" maxlength="100" required="true" requiredMessage="Informe a Razão Social" />

               <p:outputLabel for="fantasia" value="Fantasia:" />
               <p:inputText id="fantasia" value="#{empresaControle.empresa.fantasia}" size="100" maxlength="100" required="false" requiredMessage="Informe o nome Fantasia" />
            </h:panelGrid>



            <h:panelGrid id="painel5" columns="4">
               <p:outputLabel for="endereco" value="Endereco:" />
               <p:inputText id="endereco" value="#{empresaControle.empresa.endereco}" size="87" maxlength="87" required="true" requiredMessage="Informe o endereco" />
               <h:outputLabel for="num" value="Nº:" />
               <p:inputText id="num" value="#{empresaControle.empresa.numero}" size="5" maxlength="5" required="true" requiredMessage="Se não tiver número informe S/N" />
            </h:panelGrid>

            <h:panelGrid id="painel6" columns="6">
               <h:outputLabel for="comp" value="Compl.:" />
               <p:inputText id="comp" value="#{empresaControle.empresa.complemento}" size="30" maxlength="30" />
               <h:outputLabel for="bairro" value="Bairro:" />
               <p:inputText id="bairro" value="#{empresaControle.empresa.bairro}" size="39" maxlength="38" />
               <h:outputLabel for="cep" value="CEP:" />
               <p:inputMask id="cep" mask="99.999-999" value="#{empresaControle.empresa.cep}" size="10" maxlength="10" />
            </h:panelGrid>


            <h:panelGrid id="painel7" columns="4">
               <!-- 					<p:outputLabel for="estado" value="Estado:" /> -->
               <!-- 					<p:selectOneMenu id="estado" filter="true" -->
               <!-- 						converter="omnifaces.SelectItemsConverter" -->
               <!-- 						value="#{empresaControle.estado}"> -->
               <!-- 						<f:selectItem noSelectionOption="true" -->
               <!-- 							itemLabel="Selecione um estado" /> -->
               <!-- 						<f:selectItems value="#{empresaControle.estados}" var="estado" -->
               <!-- 							itemValue="#{estado}" -->
               <!-- 							itemLabel="#{estado.nome} - #{estado.sigla}" /> -->
               <!-- 						<p:ajax listener="#{empresaControle.popular}" -->
               <!-- 							update=":frmCadastro:Municipio" /> -->
               <!-- 						update=":frmCadastro" -->
               <!-- 					</p:selectOneMenu> -->

               <h:outputText value="UF" />
               <p:selectOneMenu value="#{MunicipioControle.municipio.uf}" required="true" requiredMessage="É obrigatório informar o estado!">
                  <f:selectItems value="#{ControleEnumerador.listaEnumUf}" var="item" itemLabel="#{item.descricao}" itemValue="#{item}" />
               </p:selectOneMenu>


               <p:outputLabel for="Municipio" value="Municipio:" />
               <p:selectOneMenu id="Municipio" filter="true" required="true" requiredMessage="É necessário informar uma Municipio para realizar o cadastro" converter="omnifaces.SelectItemsConverter" value="#{empresaControle.empresa.Municipio}">
                  <f:selectItem noSelectionOption="true" itemLabel="Selecione uma Municipio" />
                  <f:selectItems value="#{empresaControle.Municipios}" var="Municipio" itemValue="#{Municipio}" itemLabel="#{Municipio.nome}" />
               </p:selectOneMenu>
               <p:outputLabel for="fone" value="Telefone:" />
               <p:inputMask id="fone" mask="(99)9999-9999" required="true" requiredMessage="Informe o telefone" value="#{empresaControle.empresa.telefone}" />
            </h:panelGrid>

            <h:panelGrid columns="2">
               <p:outputLabel for="email" value="E-mail:" />
               <p:inputText id="email" value="#{empresaControle.empresa.email}" size="93" maxlength="70" />

               <p:outputLabel for="smtp" value="SMTP email:" />
               <p:inputText id="smtp" size="20" maxlength="20" value="#{empresaControle.empresa.smtp}" />

               <p:outputLabel for="portasmtp" value="Porta SMTP:" />
               <p:inputText id="portasmtp" size="10" maxlength="10" value="#{empresaControle.empresa.portaSmtp}" />

               <p:outputLabel for="senhamail" value="Senha email:" />
               <p:inputText id="senhamail" size="30" maxlength="30" value="#{empresaControle.empresa.senhaMail}" />

               <p:outputLabel for="contato" value="Contato:" />
               <p:inputText id="contato" size="20" maxlength="20" value="#{empresaControle.empresa.contato}" />
            </h:panelGrid>

            <h:panelGrid columns="4">
               <p:commandButton value="Salvar" icon="ui-icon-check" actionListener="#{empresaControle.salvar}" update=":mensagem  :frmListagem:tabela :frmCadastro" />
               <!-- :frmCadastro:painel -->
               <p:commandButton value="Cancelar" icon="ui-icon-closethick" oncomplete="PF('dialogo').hide();" />
            </h:panelGrid>



         </h:form>
      </p:dialog>



   </ui:define>
</ui:composition>