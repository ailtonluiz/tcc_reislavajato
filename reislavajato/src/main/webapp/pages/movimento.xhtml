<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/templates/modelo.xhtml">


	<p:growl id="mensagem" />

	<ui:define name="conteudo">
		<h:form id="formulario">
			<p:panel header="Serviços">
				<p:tabView>
					<p:tab title="Dados Principais">
						<p:panelGrid columns="4" id="pnlDadosPrincipais">
							<p:outputLabel for="cliente" value="Cliente" />
							<p:selectOneMenu id="cliente" filter="true"
								value="#{movimentacaoControle.movimento.cadastro}"
								converter="omnifaces.SelectItemsConverter" required="true"
								requiredMessage="É obrigatório informar um cliente!"
								filterMatchMode="contains">
								<f:selectItem noSelectionOption="true"
									itemLabel="Selecione um cliente" />
								<f:selectItems value="#{movimentacaoControle.cadastros}"
									var="cliente" itemValue="#{cliente}"
									itemLabel="#{cliente.razaoSocial} - #{cliente.cnpj} " />
							</p:selectOneMenu>

							<p:outputLabel for="veiculo" value="Veiculo" />
							<p:selectOneMenu id="veiculo" filter="true"
								value="#{movimentacaoControle.movimento.veiculo}"
								converter="omnifaces.SelectItemsConverter" required="true"
								requiredMessage="É obrigatório informar um veiculo!"
								filterMatchMode="contains">
								<f:selectItem noSelectionOption="true"
									itemLabel="Selecione um veículo" />
								<f:selectItems value="#{movimentacaoControle.veiculos}"
									var="veiculo" itemValue="#{veiculo}"
									itemLabel="#{veiculo.marca.nome} - #{veiculo.modelo} #{veiculo.cor} #{veiculo.placaVeiculo} " />
							</p:selectOneMenu>

							<p:outputLabel for="os" value="Número OS" />
							<p:inputText id="os"
								value="#{movimentacaoControle.movimento.numeroOrdem}" />

							<p:outputLabel for="km" value="Quilometragem" />
							<p:inputText id="km" value="#{movimentacaoControle.movimento.km}" />

						</p:panelGrid>

						<p:panel header="Lista de serviços">
							<p:dataTable id="tabelaProduto1"
								emptyMessage="Nenhum registro encontrado" paginator="true"
								paginatorPosition="bottom"
								value="#{movimentacaoControle.servicos}" var="servico" rows="3">

								<p:column headerText="Descrição" filterBy="#{servico.descricao}"
									filterMatchMode="contains">
									<h:outputText value="#{servico.descricao}" />
								</p:column>

								<p:column headerText="Vlr. Serviço" style="width:8%">
									<h:outputText value="#{servico.vlrServico}">
										<f:convertNumber locale="pt_BR" minFractionDigits="2" />
									</h:outputText>
								</p:column>

								<p:column headerText="Comissão" style="width:8%">
									<h:outputText value="#{servico.percComissao}">
										<f:convertNumber locale="pt_BR" minFractionDigits="2" />
									</h:outputText>
								</p:column>

								<p:column headerText="Opções" style="width:8%">
									<p:commandButton icon="ui-icon-plus"
										actionListener="#{movimentoControle.adicionar}">
										<f:attribute name="registroSelecionado" value="#{servico}" />
									</p:commandButton>
								</p:column>

							</p:dataTable>
							<!-- Fim do painel de servicços disponíveis -->
						</p:panel>



					</p:tab>

					<p:tab title="Serviços realizados">
						<p:panel header="Lista de serviços">
							<p:dataTable id="tabelaProduto"
								emptyMessage="Nenhum registro encontrado" paginator="true"
								paginatorPosition="bottom"
								value="#{movimentacaoControle.servicos}" var="servico" rows="3">

								<p:column headerText="Descrição" filterBy="#{servico.descricao}"
									filterMatchMode="contains">
									<h:outputText value="#{servico.descricao}" />
								</p:column>

								<p:column headerText="Vlr. Serviço" style="width:8%">
									<h:outputText value="#{servico.vlrServico}">
										<f:convertNumber locale="pt_BR" minFractionDigits="2" />
									</h:outputText>
								</p:column>

								<p:column headerText="Comissão" style="width:8%">
									<h:outputText value="#{servico.percComissao}">
										<f:convertNumber locale="pt_BR" minFractionDigits="2" />
									</h:outputText>
								</p:column>

								<p:column headerText="Opções" style="width:8%">
									<p:commandButton icon="ui-icon-plus"
										actionListener="#{movimentoControle.adicionar}">
										<f:attribute name="registroSelecionado" value="#{servico}" />
									</p:commandButton>
								</p:column>

							</p:dataTable>
							<!-- Fim do painel de servicços disponíveis -->
						</p:panel>

					</p:tab>
				</p:tabView>

			</p:panel>
		</h:form>
	</ui:define>
</ui:composition>